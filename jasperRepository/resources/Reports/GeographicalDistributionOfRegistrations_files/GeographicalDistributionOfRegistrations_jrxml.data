<?xml version="1.0" encoding="UTF-8"?>
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="GeographicalDistributionOfRegistrations" language="groovy" pageWidth="612" pageHeight="792" columnWidth="555" leftMargin="20" rightMargin="20" topMargin="20" bottomMargin="20" uuid="5c62c8fc-6025-423e-8313-d3b286d50a24">
	<property name="ireport.zoom" value="1.5"/>
	<property name="ireport.x" value="0"/>
	<property name="ireport.y" value="0"/>
	<style name="Crosstab Data Text" hAlign="Center"/>
	<parameter name="Enter_the_year" class="java.lang.Integer">
		<defaultValueExpression><![CDATA[]]></defaultValueExpression>
	</parameter>
	<queryString>
		<![CDATA[select location_name, male, female, COALESCE(ROUND((female/male)*1000), female*1000) AS sexRatio, total from (
select l.name location_name,
SUM(CASE WHEN p.gender = 'M' THEN 1 ELSE 0 END) AS male,
SUM(CASE WHEN p.gender = 'M' THEN 0 ELSE 1 END) AS female,
count(distinct p.person_id) total
from person p,
	person_attribute pa,
	person_attribute_type pat,
	location l
where p.person_id = pa.person_id
	and pa.person_attribute_type_id = pat.person_attribute_type_id
	and pat.name = 'Health Center'
	and pa.value = l.location_id
    and year(p.date_created) =  $P{Enter_the_year}
group by l.name
order by location_name asc) t;]]>
	</queryString>
	<field name="location_name" class="java.lang.String"/>
	<field name="male" class="java.math.BigDecimal"/>
	<field name="female" class="java.math.BigDecimal"/>
	<field name="sexRatio" class="java.math.BigDecimal"/>
	<field name="total" class="java.lang.Long"/>
	<variable name="totalMale" class="java.math.BigDecimal" calculation="Sum">
		<variableExpression><![CDATA[$F{male}]]></variableExpression>
	</variable>
	<variable name="totalFemale" class="java.math.BigDecimal" calculation="Sum">
		<variableExpression><![CDATA[$F{female}]]></variableExpression>
	</variable>
	<variable name="totalCount" class="java.math.BigDecimal" calculation="Sum">
		<variableExpression><![CDATA[$F{total}]]></variableExpression>
	</variable>
	<variable name="totalSexRatio" class="java.math.BigDecimal">
		<variableExpression><![CDATA[$V{totalMale} == 0 ? 0 : Math.round($V{totalFemale}/$V{totalMale}*1000)]]></variableExpression>
	</variable>
	<background>
		<band splitType="Stretch"/>
	</background>
	<title>
		<band height="100" splitType="Stretch">
			<image>
				<reportElement uuid="b3a45421-fc5f-4356-97d2-3829da8f9589" x="0" y="0" width="99" height="83"/>
				<imageExpression><![CDATA["repo:/Resources/jss_logo"]]></imageExpression>
			</image>
			<staticText>
				<reportElement uuid="4fb9d4bb-5af9-4150-a7df-c27c18139a70" x="99" y="0" width="471" height="43" forecolor="#FFFFFF"/>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font size="24" isBold="true"/>
				</textElement>
				<text><![CDATA[Demographic Report]]></text>
			</staticText>
			<frame>
				<reportElement uuid="b4a0e685-da35-4373-86b8-de55bec84b88" mode="Opaque" x="0" y="0" width="570" height="91" backcolor="#006699"/>
				<staticText>
					<reportElement uuid="4fb9d4bb-5af9-4150-a7df-c27c18139a70" x="99" y="20" width="456" height="43" forecolor="#FFFFFF"/>
					<textElement textAlignment="Center" verticalAlignment="Middle">
						<font size="24" isBold="true"/>
					</textElement>
					<text><![CDATA[Registrations Per SubCenter]]></text>
				</staticText>
				<image>
					<reportElement uuid="b3a45421-fc5f-4356-97d2-3829da8f9589" x="0" y="0" width="99" height="83"/>
					<imageExpression><![CDATA["repo:/Resources/jss_logo"]]></imageExpression>
				</image>
				<textField>
					<reportElement uuid="d49662d4-de8f-4d66-9aae-a62d77807be5" x="99" y="63" width="456" height="20" forecolor="#FFFFFF"/>
					<textElement textAlignment="Center" verticalAlignment="Middle">
						<font size="12"/>
					</textElement>
					<textFieldExpression><![CDATA["For year: " + $P{Enter_the_year}.toString()]]></textFieldExpression>
				</textField>
			</frame>
		</band>
	</title>
	<columnHeader>
		<band height="20">
			<staticText>
				<reportElement uuid="19e81e15-ccac-43a8-adbf-b288f780df16" mode="Opaque" x="0" y="0" width="114" height="20" backcolor="#006699"/>
				<box topPadding="1" leftPadding="1" bottomPadding="1" rightPadding="1">
					<topPen lineWidth="0.5" lineStyle="Solid"/>
					<leftPen lineWidth="0.5" lineStyle="Solid"/>
					<bottomPen lineWidth="0.5" lineStyle="Solid"/>
					<rightPen lineWidth="0.5" lineStyle="Solid"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font size="14" isBold="true"/>
				</textElement>
				<text><![CDATA[Location]]></text>
			</staticText>
			<staticText>
				<reportElement uuid="c74b571e-4567-4fc6-93ec-3048f8f70142" mode="Opaque" x="114" y="0" width="114" height="20" backcolor="#006699"/>
				<box topPadding="1" leftPadding="1" bottomPadding="1" rightPadding="1">
					<topPen lineWidth="0.5" lineStyle="Solid"/>
					<leftPen lineWidth="0.5" lineStyle="Solid"/>
					<bottomPen lineWidth="0.5" lineStyle="Solid"/>
					<rightPen lineWidth="0.5" lineStyle="Solid"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font size="14" isBold="true"/>
				</textElement>
				<text><![CDATA[Male]]></text>
			</staticText>
			<staticText>
				<reportElement uuid="7c656106-e88a-4d5b-b7d8-04fc67af5c31" mode="Opaque" x="228" y="0" width="114" height="20" backcolor="#006699"/>
				<box topPadding="1" leftPadding="1" bottomPadding="1" rightPadding="1">
					<topPen lineWidth="0.5" lineStyle="Solid"/>
					<leftPen lineWidth="0.5" lineStyle="Solid"/>
					<bottomPen lineWidth="0.5" lineStyle="Solid"/>
					<rightPen lineWidth="0.5" lineStyle="Solid"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font size="14" isBold="true"/>
				</textElement>
				<text><![CDATA[Female]]></text>
			</staticText>
			<staticText>
				<reportElement uuid="943cea43-daa1-4d1a-b04c-02e92d55beca" mode="Opaque" x="342" y="0" width="114" height="20" backcolor="#006699"/>
				<box topPadding="1" leftPadding="1" bottomPadding="1" rightPadding="1">
					<topPen lineWidth="0.5" lineStyle="Solid"/>
					<leftPen lineWidth="0.5" lineStyle="Solid"/>
					<bottomPen lineWidth="0.5" lineStyle="Solid"/>
					<rightPen lineWidth="0.5" lineStyle="Solid"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font size="14" isBold="true"/>
				</textElement>
				<text><![CDATA[Sex Ratio]]></text>
			</staticText>
			<staticText>
				<reportElement uuid="76e998d2-856c-4c7b-9c26-a35f89773066" mode="Opaque" x="456" y="0" width="114" height="20" backcolor="#006699"/>
				<box topPadding="1" leftPadding="1" bottomPadding="1" rightPadding="1">
					<topPen lineWidth="0.5" lineStyle="Solid"/>
					<leftPen lineWidth="0.5" lineStyle="Solid"/>
					<bottomPen lineWidth="0.5" lineStyle="Solid"/>
					<rightPen lineWidth="0.5" lineStyle="Solid"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font size="14" isBold="true"/>
				</textElement>
				<text><![CDATA[Total]]></text>
			</staticText>
		</band>
	</columnHeader>
	<detail>
		<band height="20">
			<textField>
				<reportElement uuid="fd067d81-7358-490a-8fca-3f0ee6247e85" x="0" y="0" width="114" height="20"/>
				<box topPadding="1" leftPadding="1" bottomPadding="1" rightPadding="1">
					<topPen lineWidth="0.5" lineStyle="Solid"/>
					<leftPen lineWidth="0.5" lineStyle="Solid"/>
					<bottomPen lineWidth="0.5" lineStyle="Solid"/>
					<rightPen lineWidth="0.5" lineStyle="Solid"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle"/>
				<textFieldExpression><![CDATA[$F{location_name}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement uuid="55a85c09-7ff6-4bcc-859d-93ecb83b24fe" x="114" y="0" width="114" height="20"/>
				<box topPadding="1" leftPadding="1" bottomPadding="1" rightPadding="1">
					<topPen lineWidth="0.5" lineStyle="Solid"/>
					<leftPen lineWidth="0.5" lineStyle="Solid"/>
					<bottomPen lineWidth="0.5" lineStyle="Solid"/>
					<rightPen lineWidth="0.5" lineStyle="Solid"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle"/>
				<textFieldExpression><![CDATA[$F{male}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement uuid="3792feee-68cc-45eb-9f16-5c5b63bcb7fd" x="228" y="0" width="114" height="20"/>
				<box topPadding="1" leftPadding="1" bottomPadding="1" rightPadding="1">
					<topPen lineWidth="0.5" lineStyle="Solid"/>
					<leftPen lineWidth="0.5" lineStyle="Solid"/>
					<bottomPen lineWidth="0.5" lineStyle="Solid"/>
					<rightPen lineWidth="0.5" lineStyle="Solid"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle"/>
				<textFieldExpression><![CDATA[$F{female}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement uuid="3b4a0a34-07aa-4735-9d1c-f72fe263e33e" mode="Opaque" x="342" y="0" width="114" height="20" backcolor="#A9C9FF"/>
				<box topPadding="1" leftPadding="1" bottomPadding="1" rightPadding="1">
					<topPen lineWidth="0.5" lineStyle="Solid"/>
					<leftPen lineWidth="0.5" lineStyle="Solid"/>
					<bottomPen lineWidth="0.5" lineStyle="Solid"/>
					<rightPen lineWidth="0.5" lineStyle="Solid"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle"/>
				<textFieldExpression><![CDATA[$F{sexRatio}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement uuid="32c1bd35-3d7e-44d7-a5da-bd7687a4c8c7" mode="Opaque" x="456" y="0" width="114" height="20" backcolor="#A9C9FF"/>
				<box topPadding="1" leftPadding="1" bottomPadding="1" rightPadding="1">
					<topPen lineWidth="0.5" lineStyle="Solid"/>
					<leftPen lineWidth="0.5" lineStyle="Solid"/>
					<bottomPen lineWidth="0.5" lineStyle="Solid"/>
					<rightPen lineWidth="0.5" lineStyle="Solid"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle"/>
				<textFieldExpression><![CDATA[$F{total}]]></textFieldExpression>
			</textField>
		</band>
	</detail>
	<summary>
		<band height="20">
			<staticText>
				<reportElement uuid="ad5734b1-6a86-4178-bab1-68e1685ed970" mode="Opaque" x="0" y="0" width="114" height="20" backcolor="#A9C9FF"/>
				<box topPadding="1" leftPadding="1" bottomPadding="1" rightPadding="1">
					<topPen lineWidth="0.5" lineStyle="Solid"/>
					<leftPen lineWidth="0.5" lineStyle="Solid"/>
					<bottomPen lineWidth="0.5" lineStyle="Solid"/>
					<rightPen lineWidth="0.5" lineStyle="Solid"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle"/>
				<text><![CDATA[TOTAL]]></text>
			</staticText>
			<textField>
				<reportElement uuid="6b35eec7-e9e2-441e-8000-0697f829e4d0" mode="Opaque" x="114" y="0" width="114" height="20" backcolor="#A9C9FF"/>
				<box topPadding="1" leftPadding="1" bottomPadding="1" rightPadding="1">
					<topPen lineWidth="0.5" lineStyle="Solid"/>
					<leftPen lineWidth="0.5" lineStyle="Solid"/>
					<bottomPen lineWidth="0.5" lineStyle="Solid"/>
					<rightPen lineWidth="0.5" lineStyle="Solid"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle"/>
				<textFieldExpression><![CDATA[$V{totalMale}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement uuid="df0c5183-d6ac-4cbd-b61d-e0c1e7da11cc" mode="Opaque" x="228" y="0" width="114" height="20" backcolor="#A9C9FF"/>
				<box topPadding="1" leftPadding="1" bottomPadding="1" rightPadding="1">
					<topPen lineWidth="0.5" lineStyle="Solid"/>
					<leftPen lineWidth="0.5" lineStyle="Solid"/>
					<bottomPen lineWidth="0.5" lineStyle="Solid"/>
					<rightPen lineWidth="0.5" lineStyle="Solid"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle"/>
				<textFieldExpression><![CDATA[$V{totalFemale}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement uuid="1d34623e-29ef-40a7-814a-1ae12eb55181" mode="Opaque" x="456" y="0" width="114" height="20" backcolor="#A9C9FF"/>
				<box topPadding="1" leftPadding="1" bottomPadding="1" rightPadding="1">
					<topPen lineWidth="0.5" lineStyle="Solid"/>
					<leftPen lineWidth="0.5" lineStyle="Solid"/>
					<bottomPen lineWidth="0.5" lineStyle="Solid"/>
					<rightPen lineWidth="0.5" lineStyle="Solid"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle"/>
				<textFieldExpression><![CDATA[$V{totalCount}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement uuid="3a6ded48-cadf-4f6e-b3c5-b86436ec9273" mode="Opaque" x="342" y="0" width="114" height="20" backcolor="#A9C9FF"/>
				<box topPadding="1" leftPadding="1" bottomPadding="1" rightPadding="1">
					<topPen lineWidth="0.5" lineStyle="Solid"/>
					<leftPen lineWidth="0.5" lineStyle="Solid"/>
					<bottomPen lineWidth="0.5" lineStyle="Solid"/>
					<rightPen lineWidth="0.5" lineStyle="Solid"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle"/>
				<textFieldExpression><![CDATA[$V{totalSexRatio}]]></textFieldExpression>
			</textField>
		</band>
	</summary>
</jasperReport>
