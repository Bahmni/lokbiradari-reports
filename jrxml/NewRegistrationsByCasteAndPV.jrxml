<?xml version="1.0" encoding="UTF-8"?>
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="NewRegistrationsByCasteAndPV" language="groovy" pageWidth="595" pageHeight="842" columnWidth="555" leftMargin="20" rightMargin="20" topMargin="20" bottomMargin="20" uuid="6dd8c7a7-ae5d-4168-af34-18f845c5e940">
	<property name="ireport.zoom" value="1.0"/>
	<property name="ireport.x" value="0"/>
	<property name="ireport.y" value="0"/>
	<style name="table">
		<box>
			<pen lineWidth="1.0" lineColor="#000000"/>
		</box>
	</style>
	<style name="table_TH" mode="Opaque" backcolor="#F0F8FF">
		<box>
			<pen lineWidth="0.5" lineColor="#000000"/>
		</box>
	</style>
	<style name="table_CH" mode="Opaque" backcolor="#BFE1FF">
		<box>
			<pen lineWidth="0.5" lineColor="#000000"/>
		</box>
	</style>
	<style name="table_TD" mode="Opaque" backcolor="#FFFFFF">
		<box>
			<pen lineWidth="0.5" lineColor="#000000"/>
		</box>
	</style>
	<style name="table 1">
		<box>
			<pen lineWidth="1.0" lineColor="#000000"/>
		</box>
	</style>
	<style name="table 1_TH" mode="Opaque" backcolor="#F0F8FF">
		<box>
			<pen lineWidth="0.5" lineColor="#000000"/>
		</box>
	</style>
	<style name="table 1_CH" mode="Opaque" backcolor="#BFE1FF">
		<box>
			<pen lineWidth="0.5" lineColor="#000000"/>
		</box>
	</style>
	<style name="table 1_TD" mode="Opaque" backcolor="#FFFFFF">
		<box>
			<pen lineWidth="0.5" lineColor="#000000"/>
		</box>
	</style>
	<subDataset name="new_registrations_by_caste_and_pv" uuid="abbc53df-7975-4fa9-9366-397e7bf37a61">
		<parameter name="startDate" class="java.lang.String">
			<defaultValueExpression><![CDATA["01/01/2000"]]></defaultValueExpression>
		</parameter>
		<parameter name="endDate" class="java.lang.String">
			<defaultValueExpression><![CDATA["01/01/2013"]]></defaultValueExpression>
		</parameter>
		<queryString>
			<![CDATA[SELECT Date_format(p.date_created, '%Y') year_created ,
       Date_format(p.date_created, '%m') month_created,
       IF(( Year(p.date_created) - Year(p.birthdate) ) < 12, 'C', p.gender)g,
       pv_name program_village,
       personat.value caste,
       Count(*)  count
FROM   person p
       INNER JOIN person_address pa
               ON p.person_id = pa.person_id
       LEFT OUTER JOIN jss_program_village pv
                    ON pa.city_village = pv.city_village
       LEFT OUTER JOIN person_attribute personat on p.person_id = personat.person_id
       LEFT OUTER JOIN person_attribute_type pat on personat.person_attribute_type_id = pat.person_attribute_type_id
WHERE  p.gender IS NOT NULL
       AND p.gender <> ''
       AND p.date_created > STR_TO_DATE($P{startDate},'%d/%m/%Y') AND p.date_created < STR_TO_DATE($P{endDate},'%d/%m/%Y')
       AND pat.name ='Caste'

GROUP  BY year_created,
          month_created,
          pv_name,
          g ,
          caste
ORDER  BY year_created ASC,
          month_created ASC,
          g ASC]]>
		</queryString>
		<field name="year_created" class="java.lang.String"/>
		<field name="month_created" class="java.lang.String"/>
		<field name="g" class="java.lang.String"/>
		<field name="program_village" class="java.lang.String"/>
		<field name="caste" class="java.lang.String"/>
		<field name="count" class="java.lang.Long"/>
	</subDataset>
	<parameter name="startDate" class="java.lang.String"/>
	<parameter name="endDate" class="java.lang.String"/>
	<queryString language="SQL">
		<![CDATA[SELECT Date_format(p.date_created, '%Y') year_created ,
       Date_format(p.date_created, '%m') month_created,
       IF(( Year(p.date_created) - Year(p.birthdate) ) < 12, 'C', p.gender)g,
       pv_name program_village,
       personat.value caste,
       Count(*)  count
FROM   person p
       INNER JOIN person_address pa
               ON p.person_id = pa.person_id
       LEFT OUTER JOIN program_village pv
                    ON pa.city_village = pv.city_village
       LEFT OUTER JOIN person_attribute personat on p.person_id = personat.person_id
       LEFT OUTER JOIN person_attribute_type pat on personat.person_attribute_type_id = pat.person_attribute_type_id
WHERE  p.gender IS NOT NULL
       AND p.gender <> '' and pat.name ='Caste'
GROUP  BY year_created,
          month_created,
          pv_name,
          g ,
          caste
ORDER  BY year_created ASC,
          month_created ASC,
          g ASC]]>
	</queryString>
	<field name="year_created" class="java.lang.String"/>
	<field name="month_created" class="java.lang.String"/>
	<field name="g" class="java.lang.String"/>
	<field name="program_village" class="java.lang.String"/>
	<field name="caste" class="java.lang.String"/>
	<field name="count" class="java.lang.Long"/>
	<background>
		<band splitType="Stretch"/>
	</background>
	<summary>
		<band height="123" splitType="Stretch">
			<componentElement>
				<reportElement uuid="9b5c11a5-25b1-40e9-b7cc-38b317433b61" key="table 1" style="table 1" x="0" y="0" width="555" height="123"/>
				<jr:table xmlns:jr="http://jasperreports.sourceforge.net/jasperreports/components" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports/components http://jasperreports.sourceforge.net/xsd/components.xsd">
					<datasetRun subDataset="new_registrations_by_caste_and_pv" uuid="7380f32d-8028-4a10-92f5-e7da45f2abb9">
						<connectionExpression><![CDATA[$P{REPORT_CONNECTION}]]></connectionExpression>
					</datasetRun>
					<jr:column uuid="63eb4a45-638c-4595-bdcb-19100cf3e77d" width="90">
						<jr:columnHeader style="table 1_CH" height="30">
							<staticText>
								<reportElement uuid="83b582fe-7e17-4815-988d-2c825b0a6921" x="0" y="0" width="90" height="30"/>
								<textElement/>
								<text><![CDATA[year_created]]></text>
							</staticText>
						</jr:columnHeader>
						<jr:detailCell style="table 1_TD" height="20">
							<textField>
								<reportElement uuid="22df9af5-0ca2-49b8-9bcd-1b78cf266648" x="0" y="0" width="90" height="20"/>
								<textElement/>
								<textFieldExpression><![CDATA[$F{year_created}]]></textFieldExpression>
							</textField>
						</jr:detailCell>
					</jr:column>
					<jr:column uuid="cf9a5b5f-a19b-43c3-bd0c-d57d392ff2ff" width="90">
						<jr:columnHeader style="table 1_CH" height="30">
							<staticText>
								<reportElement uuid="baab5545-1950-4c02-97db-2d1e68f113d9" x="0" y="0" width="90" height="30"/>
								<textElement/>
								<text><![CDATA[month_created]]></text>
							</staticText>
						</jr:columnHeader>
						<jr:detailCell style="table 1_TD" height="20">
							<textField>
								<reportElement uuid="9912f821-4b68-4e47-869b-6298a181a7b5" x="0" y="0" width="90" height="20"/>
								<textElement/>
								<textFieldExpression><![CDATA[$F{month_created}]]></textFieldExpression>
							</textField>
						</jr:detailCell>
					</jr:column>
					<jr:column uuid="faf558c6-0135-4355-a8bf-56152fdb1cf2" width="90">
						<jr:columnHeader style="table 1_CH" height="30">
							<staticText>
								<reportElement uuid="c377ba95-5d5e-47ef-a6f8-7f431ca269ca" x="0" y="0" width="90" height="30"/>
								<textElement/>
								<text><![CDATA[g]]></text>
							</staticText>
						</jr:columnHeader>
						<jr:detailCell style="table 1_TD" height="20">
							<textField>
								<reportElement uuid="35f45478-0977-46b8-8a44-403d5497b0d2" x="0" y="0" width="90" height="20"/>
								<textElement/>
								<textFieldExpression><![CDATA[$F{g}]]></textFieldExpression>
							</textField>
						</jr:detailCell>
					</jr:column>
					<jr:column uuid="0e05a86a-e014-4494-a021-dffe8a5e1962" width="90">
						<jr:columnHeader style="table 1_CH" height="30">
							<staticText>
								<reportElement uuid="0f36e452-af3c-42f3-8e0c-649e387cc399" x="0" y="0" width="90" height="30"/>
								<textElement/>
								<text><![CDATA[program_village]]></text>
							</staticText>
						</jr:columnHeader>
						<jr:detailCell style="table 1_TD" height="20">
							<textField>
								<reportElement uuid="038ed7b2-c1c0-4d6e-93f0-cfd285abe855" x="0" y="0" width="90" height="20"/>
								<textElement/>
								<textFieldExpression><![CDATA[$F{program_village}]]></textFieldExpression>
							</textField>
						</jr:detailCell>
					</jr:column>
					<jr:column uuid="0e0134f8-079b-4736-a23c-1309b762da7a" width="90">
						<jr:columnHeader style="table 1_CH" height="30">
							<staticText>
								<reportElement uuid="f9e4e486-5528-4082-81e1-62b5e9edac79" x="0" y="0" width="90" height="30"/>
								<textElement/>
								<text><![CDATA[caste]]></text>
							</staticText>
						</jr:columnHeader>
						<jr:detailCell style="table 1_TD" height="20">
							<textField>
								<reportElement uuid="4dda63de-23e3-4e36-b933-f6c5d3593f5f" x="0" y="0" width="90" height="20"/>
								<textElement/>
								<textFieldExpression><![CDATA[$F{caste}]]></textFieldExpression>
							</textField>
						</jr:detailCell>
					</jr:column>
					<jr:column uuid="21903c4e-5e8e-4c61-a59d-ab662ff3f64b" width="90">
						<jr:columnHeader style="table 1_CH" height="30">
							<staticText>
								<reportElement uuid="39e88adf-0adb-4dd0-b1cd-b1b121ebbc0e" x="0" y="0" width="90" height="30"/>
								<textElement/>
								<text><![CDATA[count]]></text>
							</staticText>
						</jr:columnHeader>
						<jr:detailCell style="table 1_TD" height="20">
							<textField>
								<reportElement uuid="3d09b718-7715-4020-aa5b-2757a60af9f9" x="0" y="0" width="90" height="20"/>
								<textElement/>
								<textFieldExpression><![CDATA[$F{count}]]></textFieldExpression>
							</textField>
						</jr:detailCell>
					</jr:column>
				</jr:table>
			</componentElement>
		</band>
	</summary>
</jasperReport>
